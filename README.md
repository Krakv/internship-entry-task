# Описание API

## Endpoints

### 1. Создание новой игры
`POST /api/games`

**Ответ (201 Created):**
```json
{
  "id": "1",
  "boardSize": 3,
  "status": "InProgress"
}
```

### 2. Получение состояния игры
`GET /api/games/{id}`

**Ответ (200 OK):**
```json
{
  "boardState": "X-O-XO--X",
  "currentPlayer": "O",
  "status": "InProgress"
}
```

### 3. Совершение хода
`POST /api/games/{id}/moves`

**Запрос:**
```json
{
  "player": "X",
  "row": 1,
  "col": 1
}
```

**Ответ (200 OK):**
```json
{
  "newBoardState": "X-OXXO--X",
  "status": "XWon"
}
```

## Коды ошибок
`400 Bad Request` - Некорректный ход
`404 Not Found` - Игра не найдена
`409 Conflict` - Игра завершена
`412 Precondition Failed` - Конфликт версий

# Описание архитектуры

1. Controllers - только HTTP-запросы/ответы
2. Services - правила игры, проверка ходов, определение победителя
3. Repositories - работа с БД: CRUD операций, EF Core
4. Models - сущности БД: Game, Move...
5. DTOs - передача данных

# Задача #1 на стажировку backend разработчик Банка C#/PostgreSQL

Спроектируйте и реализуйте REST API для игры в крестики нолики

Должен поддерживаться формат сообщений json. 

## Описание

Для разработки сайта и мобильного приложения для игры в крестики нолики NxN (N >= 3) для двух игроков требуется реализовать web api. Игра проходит по обычным правилам, за исключением одного - каждый третий ход игры существует вероятность 10%, что поставится значок противника.

- создание новой игры,
- ходы двух игроков,
- фиксация победы или ничьей.
- размер поля и условия победы задаются через переменные окружения

Платформа

- **Платформа:** .NET 9
- **Хранилище:** любая СУБД (можно файловую).

## Формат решения

### Обязательно:

- Вы делаете форк от этого репозитория и предоставляете ссылку PR с вашим решением
- проект должен быть выложен на GitHub и открываться с помощьюм VS2022
- в readme.md репозитория или на выделенной онлайн странице должно быть описание API и принятых архитектурных решений
- проект собирается в докер и разворачиватся в рабочее состояние docker-compose up

## Автоматическая проверка

### Запуск

- В репозитории есть **`Dockerfile`** (обязательно) и при необходимости **`docker-compose.yml`**.
- Приложение внутри контейнера слушает **порт 8080**.
- На запрос `GET /health` отвечает `200 OK`.

### Тесты

- Есть интеграционные и unit тесты
- Минимальное покрытие кода — **30 %**.
- Запуск тестов в CI и локально — `dotnet test` (или аналогичная команда).

### Дополнительные тонкости (обязательно)

- **Concurrency & идемпотентность**  
   При гонке двух `POST /moves` с одинаковым телом второй запрос обязан вернуть 200 OK и тот же `ETag`.

- **Persistence crash-safe**  
   После перезапуска контейнера мы выполняем `GET /games/{id}` и делаем следующий ход. Сессия игрока сохраняется.

- **Негативные тесты**  
   Любой некорректный JSON (пример ниже) → HTTP 400 (RFC 7807)

## Цель задания

Предоставить кандидату возможность продемонстрировать свои знания
